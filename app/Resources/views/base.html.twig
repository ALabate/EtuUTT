
{% import ':Macro:subscribe.html.twig' as etu_subscribe %}

<!DOCTYPE html>
<html lang="fr" class="bg-soft-grey">
	<head>
		<meta charset="utf-8">

		<title>{% block title %}{{ 'home.index.page.title' }}{% endblock %} - {{ 'base.title'|trans }}</title>

		<meta name="description" content="{{ 'base.title'|trans }}" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

		{# Assets managment with Assetic: to use in production, but too slow for development

		{% stylesheets
			'bootstrap/css/bootstrap.min.css'
			'bootstrap/css/bootstrap-responsive.min.css'

			'css/global.css'
			'css/icons.css'
			'css/head.css'
			'css/page.css'
			'css/sidebar.css'
			'css/responsive.css'
			'css/content.css'

			filter='cssrewrite'
			output='css/compiled.css'
		%}
			<link rel="stylesheet" href="{{ asset_url }}" type="text/css" />
		{% endstylesheets %}
		#}

		<link rel="stylesheet" href="{{ asset('bootstrap/css/bootstrap.min.css') }}" type="text/css" />
		<link rel="stylesheet" href="{{ asset('bootstrap/css/bootstrap-responsive.min.css') }}" type="text/css" />
		<link rel="stylesheet" href="{{ asset('css/global.css') }}" type="text/css" />
		<link rel="stylesheet" href="{{ asset('css/icons.css') }}" type="text/css" />
		<link rel="stylesheet" href="{{ asset('css/head.css') }}" type="text/css" />
		<link rel="stylesheet" href="{{ asset('css/page.css') }}" type="text/css" />
		<link rel="stylesheet" href="{{ asset('css/menu.css') }}" type="text/css" />
		<link rel="stylesheet" href="{{ asset('css/responsive.css') }}" type="text/css" />
		<link rel="stylesheet" href="{{ asset('css/content.css') }}" type="text/css" />

		<link rel="stylesheet" href="{{ asset('redactor-js/redactor/redactor.css') }}" />

		{% block stylesheets %}{% endblock %}
	</head>
	<body class="bg-soft-grey">
		<header class="bg-dark-blue fixed head">
			<div class="container">
				<div class="pull-left title">
					<h1 class="seo-title">{{ block('title') }} - {{ 'base.title'|trans }}</h1>

					<a href="{{ path('homepage') }}">
						<img src="{{ asset('img/logo.jpg') }}" alt="{{ 'base.logo.alt'|trans }}" title="{{ 'base.logo.title'|trans }}" class="logo" />
					</a>
				</div>

				<nav class="pull-left">
					<ul class="list-horizontal list-horizontal-linked menu" id="head-menu-list">
						<li class="first{% block main_menu_link_homepage %}{% endblock %}">
							{% if etu_count_new_notifs == 0 %}
							<span id="head-menu-home-pins" class="pins pins-alert pins-head pins-head-hidden">0</span>
							{% else %}
							<span id="head-menu-home-pins" class="pins pins-alert pins-head">{{ etu_count_new_notifs }}</span>
							{% endif %}

							<a href="{{ path('homepage') }}">
								<i class="icon icon-head icon-head-home"></i>
								<span class="menu-link-text">{{ 'base.menu.home'|trans }}</span>
							</a>
						</li>
						<li>
							<a href="">
								<i class="icon icon-head icon-head-events"></i>
								<span class="menu-link-text">{{ 'base.menu.events'|trans }}</span>
							</a>
						</li>
						<li>
							<a href="">
								<i class="icon icon-head icon-head-forums"></i>
								<span class="menu-link-text">{{ 'base.menu.forums'|trans }}</span>
							</a>
						</li>
						<li class="hidden-for-phones">
							<a href="">
								<i class="icon icon-head icon-head-associations"></i>
								<span class="menu-link-text">{{ 'base.menu.associations'|trans }}</span>
							</a>
						</li>
						<li class="hidden-for-phones last">
							<a href="">
								<i class="icon icon-head icon-head-search"></i>
								<span class="menu-link-text">{{ 'base.menu.search'|trans }}</span>
							</a>
						</li>
						<li class="display-for-phones last" id="more">
							<a href="">
								<i class="icon icon-head icon-head-plus"></i>
								<span class="menu-link-text">{{ 'base.menu.more'|trans }}</span>
							</a>
						</li>
						{% if not app.user %}
							<li class="last connect_link">
								<a href="{{ path('user_connect') }}">
									<i class="icon icon-head icon-head-connexion"></i>
									<span class="menu-link-text">{{ 'base.menu.connexion'|trans }}</span>
								</a>
							</li>
						{% endif %}
					</ul>
				</nav>

				<div class="pull-right userbox">
					{% if app.user %}
					<img src="{{ asset('photos/'~app.user.avatar) }}" alt="{{ app.user.fullName }}" title="{{ app.user.fullName }}" class="pull-left avatar" />

					<a href="" class="userbox-link">
						<i class="icon-chevron-down userbox-link-icon"></i>

						<span class="hidden-for-1024">
							{{ app.user.fullName }}<br />
							<span class="color-soft">
								{% if app.user.isStudent %}
									{{ 'base.user.types.student'|trans }}
								{% elseif app.user.isOrga %}
									{{ 'base.user.types.orga'|trans }}
								{% else %}
									{{ 'base.user.types.external'|trans }}
								{% endif %}
							</span>
						</span>
					</a>

					<div class="userbox-menu">
						<div class="userbox-display-for-1024 display-for-1024">
							{{ app.user.fullName }}<br />
							<span class="color-soft">
								{% if app.user.isStudent %}
									{{ 'base.user.types.student'|trans }}
								{% elseif app.user.isOrga %}
									{{ 'base.user.types.orga'|trans }}
								{% else %}
									{{ 'base.user.types.external'|trans }}
								{% endif %}
							</span>
						</div>

						{% if not app.user.isOrga %}
							{{ render_user_menu() }}
						{% else %}
							<ul class="list-vertical list-vertical-linked">
								<li >
									<a href="{{ path('homepage') }}" >
										<i class="etu-icon-gear"></i>
										{{ 'base.user.menu.orgaAdmin'|trans }}
									</a>
								</li>
								<li >
									<a href="{{ path('user_disconnect') }}">
										<i class="etu-icon-power"></i>
										{{ 'base.user.menu.logout'|trans }}
									</a>
								</li>
							</ul>
							<hr class="separator" />
							<ul class="list-vertical list-vertical-linked">
								<li >
									<a href="" >
										<i class="etu-icon-question"></i>
										{{ 'base.user.menu.help'|trans }}
									</a>
								</li>
							</ul>
						{% endif %}
					</div>
					{% endif %}
				</div>
			</div>
		</header>

		{% set message = false %}

		{% if app.session.flashBag.has('message') %}
			{% set message = app.session.flashBag.get('message') %}

			<div class="page-alert alert alert-{{ message.type }} hidden-for-1024">
				{{ message.message|trans }}
			</div>
		{% endif %}

		<div id="overlay"></div>

		<div id="overlay-content">
			<ul class="list-vertical list-vertical-linked overlay-menu">
				<li class="first active">
					<a href="">
						<i class="etu-icon-briefcase"></i>
						{{ 'base.sidebar.services.items.uvs'|trans }}
					</a>
				</li>
				<li>
					<a href="">
						<i class="etu-icon-book"></i>
						{{ 'base.sidebar.services.items.trombi'|trans }}
					</a>
				</li>
				<li>
					<a href="">
						<i class="etu-icon-info"></i>
						{{ 'base.sidebar.services.items.wiki'|trans }}
					</a>
				</li>
			</ul>

			<hr class="separator" />

			<ul class="list-vertical list-vertical-linked overlay-menu">
				<li class="first active">
					<a href="">
						<i class="etu-icon-users"></i>
						{{ 'base.sidebar.etu.items.team'|trans }}
					</a>
				</li>
				{% if etu.moduleEnabled('bugs') %}
				<li>
					<a href="{{ path('bugs_suggestions') }}">
						<i class="etu-icon-comment"></i>
						{{ 'bugs.sidebar.items.suggest'|trans }}
					</a>
				</li>
				<li>
					<a href="{{ path('bugs_index') }}">
						<i class="etu-icon-warning"></i>
						{{ 'bugs.sidebar.items.bugs'|trans }}
					</a>
				</li>
				{% endif %}
			</ul>

			<hr class="separator" />

			<ul class="list-vertical list-vertical-linked overlay-menu">
				<li class="first active">
					<a href="">
						Changer de langue (FranÃ§ais)
					</a>
				</li>
			</ul>

			<p class="clear footer-description footer-description-mobiles">
				{{ 'base.footer.mobile_text'|trans|raw }}
			</p>
		</div>

		{% block page %}{% endblock %}

		<script src="{{ asset('js/jquery-1.8.2.min.js') }}" type="text/javascript"></script>
		<script src="{{ asset('bundles/fosjsrouting/js/router.js') }}"></script>
		<script src="{{ path('fos_js_routing_js', {"callback": "fos.Router.setData"}) }}"></script>
		<script src="{{ asset('redactor-js/redactor/redactor.min.js') }}" type="text/javascript"></script>
		<script src="{{ asset('redactor-js/redactor/langs/fr.js') }}" type="text/javascript"></script>
		<script src="{{ asset('js/common.js') }}" type="text/javascript"></script>

		{% block checkout_notifications %}
			{% if app.user and not app.user.isOrga %}
				<script>
					window.setInterval(function(){
						// Find new notifications
						$.getJSON(Routing.generate('notifs_new'), function(data) {
							if (typeof data.status != 'undefined' && data.status == 200) {
								if (data.result > 0) {
									$('#head-menu-home-pins').text(data.result);
									$('#head-menu-home-pins').show();

									setCountTitle(data.result);
								}
							}
						});
					}, 10 * 1000); // 10 seconds
				</script>
			{% endif %}
		{% endblock %}

		{% block javascripts %}{% endblock %}
	</body>
</html>